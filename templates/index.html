<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Zoff.ai</title>
  <button class="theme-toggle" onclick="toggleTheme()">
  ðŸŒ“ Toggle theme
</button>

  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>

<div class="container">
  <header class="app-header">
  <h1>Zoff<span>.AI</span></h1>
  <p class="tagline">
    AIâ€‘powered contract review with clear, trackable changes
  </p>
</header>
  <p class="subtitle">Upload a contract, describe the changes you want, and let AI revise it instantly.
  All modifications are highlighted clearly so you can review, download, and approve with confidence.</p>

  <div class="upload">
    <input type="file" id="fileInput" accept=".docx" />
    <button onclick="uploadContract()">Upload & Preview</button>
  </div>

  <div class="grid">
    <div class="panel">
      <h2>Original Contract</h2>
      <pre id="originalText">No document loaded</pre>
    </div>

    <div class="panel">
      <h2>Change Instructions</h2>
      <textarea id="instructions" placeholder="Example: Change payment terms to Net 30 and set governing law to UAE">
      </textarea>

      <button id="processBtn" disabled onclick="processChanges()">
        Process Changes
      </button>
    </div>
  </div>
</div>

<script>
let contractText = "";

async function uploadContract() {
  const file = document.getElementById("fileInput").files[0];
  if (!file) return alert("Select a file");

  const fd = new FormData();
  fd.append("file", file);

  const res = await fetch("/preview", { method: "POST", body: fd });
  const data = await res.json();

  contractText = data.contract_text;
  document.getElementById("originalText").textContent = contractText;
  document.getElementById("processBtn").disabled = false;
}

async function processChanges() {
  const instructions = document.getElementById("instructions").value;
  if (!instructions) return alert("Enter instructions");

  const fd = new FormData();
  fd.append("contract_text", contractText);
  fd.append("change_instructions", instructions);

  const res = await fetch("/process", { method: "POST", body: fd });

  document.open();
  document.write(await res.text());
  document.close();
}
</script>
<script>
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute("data-theme");

  if (current === "dark") {
    html.removeAttribute("data-theme");
    localStorage.removeItem("theme");
  } else {
    html.setAttribute("data-theme", "dark");
    localStorage.setItem("theme", "dark");
  }
}

/* Persist theme */
(function () {
  if (localStorage.getItem("theme") === "dark") {
    document.documentElement.setAttribute("data-theme", "dark");
  }
})();
</script>
<footer class="app-footer">
  <p>
    Built by <strong>Hiba Arshad</strong> & <strong>Charbel Mezawi</strong><br>
    Idea by <strong>Faiz Kaleem</strong>
  </p>
</footer>
</body>
</html>
